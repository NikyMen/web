<% if (productos.length === 0) { %>
  <p class="text-center text-gray-600 mt-10">No se encontraron productos.</p>
<% } else { %>
  <p class="text-gray-700 mb-4">
    Se encontraron <strong><%= totalResultados %></strong> productos para "<%= termino %>".
  </p>

  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-6">
    <% productos.forEach((p) => { %>
      <div class="bg-white rounded shadow p-4 transition transform hover:shadow-lg hover:-translate-y-2 flex flex-col sm:flex-col">

        <!-- Mobile: diseño horizontal -->
        <div class="flex flex-row sm:flex-col gap-3 items-center sm:items-start">
          <img src="<%= p.imagen %>" alt="<%= p.nombre %>" class="w-28 h-28 object-contain flex-shrink-0 sm:w-full sm:h-40" />

          <div class="flex flex-col justify-between h-full w-full sm:hidden">
            <h3 class="font-bold text-gray-900 text-sm"><%= p.nombre %></h3>
            <p class="text-blue-700 font-semibold my-1">$ <%= p.precio.toLocaleString('es-AR') %></p>
            <a href="/producto/<%= p.codigo.trim() %>"
               class="bg-blue-700 text-white px-3 py-1.5 rounded text-xs font-semibold text-center hover:bg-blue-800">
              🔍 Ver detalle
            </a>
          </div>
        </div>

        <!-- Desktop: info completa vertical -->
        <div class="hidden sm:block mt-4">
          <h3 class="font-bold text-gray-900 text-sm mb-1"><%= p.nombre %></h3>
          <p class="text-blue-700 font-semibold mb-3">$ <%= p.precio.toLocaleString('es-AR') %></p>
          <a href="/producto/<%= p.codigo.trim() %>"
             class="block text-center bg-blue-700 text-white px-3 py-2 rounded text-sm font-semibold hover:bg-blue-800">
            🔍 Ver detalle
          </a>
        </div>
      </div>
    <% }); %>
  </div>

  <!-- Paginación -->
  <% if (totalPaginas > 1) { %>
    <div class="flex justify-center items-center gap-1 mt-10 flex-wrap">
      <% if (paginaActual > 1) { %>
        <a href="?buscar=<%= termino %>&page=<%= paginaActual - 1 %>" class="px-3 py-2 bg-gray-200 text-sm rounded hover:bg-gray-300">
          « Anterior
        </a>
      <% } %>

      <% 
        const mostrar = 5
        let inicio = Math.max(1, paginaActual - Math.floor(mostrar / 2))
        let fin = Math.min(totalPaginas, inicio + mostrar - 1)
        if (fin - inicio < mostrar - 1) inicio = Math.max(1, fin - mostrar + 1)
      %>

      <% for (let i = inicio; i <= fin; i++) { %>
        <a
          href="?buscar=<%= termino %>&page=<%= i %>"
          class="px-3 py-2 rounded text-sm <%= i === paginaActual ? 'bg-blue-800 text-white font-bold' : 'bg-gray-200 hover:bg-gray-300' %>">
          <%= i %>
        </a>
      <% } %>

      <% if (paginaActual < totalPaginas) { %>
        <a href="?buscar=<%= termino %>&page=<%= paginaActual + 1 %>" class="px-3 py-2 bg-gray-200 text-sm rounded hover:bg-gray-300">
          Siguiente »
        </a>
      <% } %>
    </div>
  <% } %>
<% } %>